<!DOCTYPE html>
<html lang="vi" class="js csstransforms3d">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="generator" content="Hugo 0.124.0">
    <meta name="description" content="">
<meta name="author" content="journeyoftheaverageguy@gmail.com">

    <link rel="icon" href="/images/favicon.png" type="image/png">

    <title>Chuẩn bị dữ liệu mẫu :: Serverless Data Lake Jump Start</title>

    
    <link href="/css/nucleus.css?1752741802" rel="stylesheet">
    <link href="/css/fontawesome-all.min.css?1752741802" rel="stylesheet">
    <link href="/css/hybrid.css?1752741802" rel="stylesheet">
    <link href="/css/featherlight.min.css?1752741802" rel="stylesheet">
    <link href="/css/perfect-scrollbar.min.css?1752741802" rel="stylesheet">
    <link href="/css/auto-complete.css?1752741802" rel="stylesheet">
    <link href="/css/atom-one-dark-reasonable.css?1752741802" rel="stylesheet">
    <link href="/css/theme.css?1752741802" rel="stylesheet">
    <link href="/css/hugo-theme.css?1752741802" rel="stylesheet">
    
    <link href="/css/theme-workshop.css?1752741802" rel="stylesheet">
    
    

    <script src="/js/jquery-3.3.1.min.js?1752741802"></script>

    <style>
      :root #header + #content > #left > #rlblock_left{
          display:none !important;
      }
      
    </style>
    
  </head>
  <body class="" data-url="/vi/6-data-ingestion/1-prepare-data/">
    <nav id="sidebar" class="showVisitedLinks">



  <div id="header-wrapper">
    <div id="header">
      <a id="logo" href="/">

<svg id="Layer_1" data-name="Layer 1" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 60 30" width="30%"><defs><style>.cls-1{fill:#fff;}.cls-2{fill:#f90;fill-rule:evenodd;}</style></defs><title>AWS-Logo_White-Color</title><path class="cls-1" d="M14.09,10.85a4.7,4.7,0,0,0,.19,1.48,7.73,7.73,0,0,0,.54,1.19.77.77,0,0,1,.12.38.64.64,0,0,1-.32.49l-1,.7a.83.83,0,0,1-.44.15.69.69,0,0,1-.49-.23,3.8,3.8,0,0,1-.6-.77q-.25-.42-.51-1a6.14,6.14,0,0,1-4.89,2.3,4.54,4.54,0,0,1-3.32-1.19,4.27,4.27,0,0,1-1.22-3.2A4.28,4.28,0,0,1,3.61,7.75,6.06,6.06,0,0,1,7.69,6.46a12.47,12.47,0,0,1,1.76.13q.92.13,1.91.36V5.73a3.65,3.65,0,0,0-.79-2.66A3.81,3.81,0,0,0,7.86,2.3a7.71,7.71,0,0,0-1.79.22,12.78,12.78,0,0,0-1.79.57,4.55,4.55,0,0,1-.58.22l-.26,0q-.35,0-.35-.52V2a1.09,1.09,0,0,1,.12-.58,1.2,1.2,0,0,1,.47-.35A10.88,10.88,0,0,1,5.77.32,10.19,10.19,0,0,1,8.36,0a6,6,0,0,1,4.35,1.35,5.49,5.49,0,0,1,1.38,4.09ZM7.34,13.38a5.36,5.36,0,0,0,1.72-.31A3.63,3.63,0,0,0,10.63,12,2.62,2.62,0,0,0,11.19,11a5.63,5.63,0,0,0,.16-1.44v-.7a14.35,14.35,0,0,0-1.53-.28,12.37,12.37,0,0,0-1.56-.1,3.84,3.84,0,0,0-2.47.67A2.34,2.34,0,0,0,5,11a2.35,2.35,0,0,0,.61,1.76A2.4,2.4,0,0,0,7.34,13.38Zm13.35,1.8a1,1,0,0,1-.64-.16,1.3,1.3,0,0,1-.35-.65L15.81,1.51a3,3,0,0,1-.15-.67.36.36,0,0,1,.41-.41H17.7a1,1,0,0,1,.65.16,1.4,1.4,0,0,1,.33.65l2.79,11,2.59-11A1.17,1.17,0,0,1,24.39.6a1.1,1.1,0,0,1,.67-.16H26.4a1.1,1.1,0,0,1,.67.16,1.17,1.17,0,0,1,.32.65L30,12.39,32.88,1.25A1.39,1.39,0,0,1,33.22.6a1,1,0,0,1,.65-.16h1.54a.36.36,0,0,1,.41.41,1.36,1.36,0,0,1,0,.26,3.64,3.64,0,0,1-.12.41l-4,12.86a1.3,1.3,0,0,1-.35.65,1,1,0,0,1-.64.16H29.25a1,1,0,0,1-.67-.17,1.26,1.26,0,0,1-.32-.67L25.67,3.64,23.11,14.34a1.26,1.26,0,0,1-.32.67,1,1,0,0,1-.67.17Zm21.36.44a11.28,11.28,0,0,1-2.56-.29,7.44,7.44,0,0,1-1.92-.67,1,1,0,0,1-.61-.93v-.84q0-.52.38-.52a.9.9,0,0,1,.31.06l.42.17a8.77,8.77,0,0,0,1.83.58,9.78,9.78,0,0,0,2,.2,4.48,4.48,0,0,0,2.43-.55,1.76,1.76,0,0,0,.86-1.57,1.61,1.61,0,0,0-.45-1.16A4.29,4.29,0,0,0,43,9.22l-2.41-.76A5.15,5.15,0,0,1,38,6.78a3.94,3.94,0,0,1-.83-2.41,3.7,3.7,0,0,1,.45-1.85,4.47,4.47,0,0,1,1.19-1.37A5.27,5.27,0,0,1,40.51.29,7.4,7.4,0,0,1,42.6,0a8.87,8.87,0,0,1,1.12.07q.57.07,1.08.19t.95.26a4.27,4.27,0,0,1,.7.29,1.59,1.59,0,0,1,.49.41.94.94,0,0,1,.15.55v.79q0,.52-.38.52a1.76,1.76,0,0,1-.64-.2,7.74,7.74,0,0,0-3.2-.64,4.37,4.37,0,0,0-2.21.47,1.6,1.6,0,0,0-.79,1.48,1.58,1.58,0,0,0,.49,1.18,4.94,4.94,0,0,0,1.83.92L44.55,7a5.08,5.08,0,0,1,2.57,1.6A3.76,3.76,0,0,1,47.9,11a4.21,4.21,0,0,1-.44,1.93,4.4,4.4,0,0,1-1.21,1.47,5.43,5.43,0,0,1-1.85.93A8.25,8.25,0,0,1,42.05,15.62Z"></path><path class="cls-2" d="M45.19,23.81C39.72,27.85,31.78,30,25,30A36.64,36.64,0,0,1,.22,20.57c-.51-.46-.06-1.09.56-.74A49.78,49.78,0,0,0,25.53,26.4,49.23,49.23,0,0,0,44.4,22.53C45.32,22.14,46.1,23.14,45.19,23.81Z"></path><path class="cls-2" d="M47.47,21.21c-.7-.9-4.63-.42-6.39-.21-.53.06-.62-.4-.14-.74,3.13-2.2,8.27-1.57,8.86-.83s-.16,5.89-3.09,8.35c-.45.38-.88.18-.68-.32C46.69,25.8,48.17,22.11,47.47,21.21Z"></path></svg>

</a>

    </div>
    
        <div class="searchbox">
    <label for="search-by"><i class="fas fa-search"></i></label>
    <input data-search-input id="search-by" type="search" placeholder="Search...">
    <span data-search-clear=""><i class="fas fa-times"></i></span>
</div>

<script type="text/javascript" src="/js/lunr.min.js?1752741802"></script>
<script type="text/javascript" src="/js/auto-complete.js?1752741802"></script>
<script type="text/javascript">
    
        var baseurl = "\/\/vi";
    
</script>
<script type="text/javascript" src="/js/search.js?1752741802"></script>

    
  </div>

    <div class="highlightable">
    <ul class="topics">

        
          
          




 
  
    
    <li data-nav-id="/vi/1-prerequisite/" title="Các bước chuẩn bị" class="dd-item 
        
        
        
        ">
      <a href="/vi/1-prerequisite/">
          <b>1. </b>Các bước chuẩn bị
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
      
        <ul>
          
          
            
          
          
          
        
          
            
            




 
  
    
    <li data-nav-id="/vi/1-prerequisite/1-aws-console/" title="Đăng nhập vào AWS Management Console" class="dd-item 
        
        
        
        ">
      <a href="/vi/1-prerequisite/1-aws-console/">
          <b>1.1 </b>Đăng nhập vào AWS Management Console
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
              
    </li>
  
 

            
          
            
            




 
  
    
    <li data-nav-id="/vi/1-prerequisite/2-cloudshell/" title="Mở AWS CloudShell" class="dd-item 
        
        
        
        ">
      <a href="/vi/1-prerequisite/2-cloudshell/">
          <b>1.2 </b>Mở AWS CloudShell
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
              
    </li>
  
 

            
          
            
            




 
  
    
    <li data-nav-id="/vi/1-prerequisite/3-region-selection/" title="Chọn region phù hợp" class="dd-item 
        
        
        
        ">
      <a href="/vi/1-prerequisite/3-region-selection/">
          <b>1.3 </b>Chọn region phù hợp
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
              
    </li>
  
 

            
          
        
        </ul>
              
    </li>
  
 

          
          




 
  
    
    <li data-nav-id="/vi/2-foundations/" title="Triển khai SDLF Foundations" class="dd-item 
        
        
        
        ">
      <a href="/vi/2-foundations/">
          <b>2. </b>Triển khai SDLF Foundations
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
      
        <ul>
          
          
            
          
          
          
        
          
            
            




 
  
    
    <li data-nav-id="/vi/2-foundations/1-clone-repository/" title="Clone repository SDLF" class="dd-item 
        
        
        
        ">
      <a href="/vi/2-foundations/1-clone-repository/">
          <b>2.1 </b>Clone repository SDLF
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
              
    </li>
  
 

            
          
            
            




 
  
    
    <li data-nav-id="/vi/2-foundations/2-configure-parameters/" title="Cấu hình parameters" class="dd-item 
        
        
        
        ">
      <a href="/vi/2-foundations/2-configure-parameters/">
          <b>2.2 </b>Cấu hình parameters
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
              
    </li>
  
 

            
          
            
            




 
  
    
    <li data-nav-id="/vi/2-foundations/3-deploy-cloudformation/" title="Triển khai CloudFormation" class="dd-item 
        
        
        
        ">
      <a href="/vi/2-foundations/3-deploy-cloudformation/">
          <b>2.3 </b>Triển khai CloudFormation
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
              
    </li>
  
 

            
          
            
            




 
  
    
    <li data-nav-id="/vi/2-foundations/4-verify-deployment/" title="Kiểm tra kết quả triển khai" class="dd-item 
        
        
        
        ">
      <a href="/vi/2-foundations/4-verify-deployment/">
          <b>2.4 </b>Kiểm tra kết quả triển khai
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
              
    </li>
  
 

            
          
        
        </ul>
              
    </li>
  
 

          
          




 
  
    
    <li data-nav-id="/vi/3-cicd-pipeline/" title="Thiết lập CI/CD Pipeline" class="dd-item 
        
        
        
        ">
      <a href="/vi/3-cicd-pipeline/">
          <b>3. </b>Thiết lập CI/CD Pipeline
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
      
        <ul>
          
          
            
          
          
          
        
          
            
            




 
  
    
    <li data-nav-id="/vi/3-cicd-pipeline/1-create-repositories/" title="Tạo CodeCommit repositories" class="dd-item 
        
        
        
        ">
      <a href="/vi/3-cicd-pipeline/1-create-repositories/">
          <b>3.1 </b>Tạo CodeCommit repositories
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
              
    </li>
  
 

            
          
            
            




 
  
    
    <li data-nav-id="/vi/3-cicd-pipeline/2-configure-codebuild/" title="Cấu hình CodeBuild" class="dd-item 
        
        
        
        ">
      <a href="/vi/3-cicd-pipeline/2-configure-codebuild/">
          <b>3.2 </b>Cấu hình CodeBuild
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
              
    </li>
  
 

            
          
            
            




 
  
    
    <li data-nav-id="/vi/3-cicd-pipeline/3-setup-codepipeline/" title="Thiết lập CodePipeline" class="dd-item 
        
        
        
        ">
      <a href="/vi/3-cicd-pipeline/3-setup-codepipeline/">
          <b>3.3 </b>Thiết lập CodePipeline
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
              
    </li>
  
 

            
          
            
            




 
  
    
    <li data-nav-id="/vi/3-cicd-pipeline/4-test-pipeline/" title="Kiểm tra pipeline" class="dd-item 
        
        
        
        ">
      <a href="/vi/3-cicd-pipeline/4-test-pipeline/">
          <b>3.4 </b>Kiểm tra pipeline
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
              
    </li>
  
 

            
          
        
        </ul>
              
    </li>
  
 

          
          




 
  
    
    <li data-nav-id="/vi/4-team-dataset/" title="Đăng ký Team và Dataset" class="dd-item 
        
        
        
        ">
      <a href="/vi/4-team-dataset/">
          <b>4. </b>Đăng ký Team và Dataset
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
      
        <ul>
          
          
            
          
          
          
        
          
            
            




 
  
    
    <li data-nav-id="/vi/4-team-dataset/1-register-team/" title="Đăng ký team" class="dd-item 
        
        
        
        ">
      <a href="/vi/4-team-dataset/1-register-team/">
          <b>4.1 </b>Đăng ký team
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
              
    </li>
  
 

            
          
            
            




 
  
    
    <li data-nav-id="/vi/4-team-dataset/2-create-dataset/" title="Tạo dataset" class="dd-item 
        
        
        
        ">
      <a href="/vi/4-team-dataset/2-create-dataset/">
          <b>4.2 </b>Tạo dataset
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
              
    </li>
  
 

            
          
            
            




 
  
    
    <li data-nav-id="/vi/4-team-dataset/3-configure-permissions/" title="Thiết lập quyền truy cập" class="dd-item 
        
        
        
        ">
      <a href="/vi/4-team-dataset/3-configure-permissions/">
          <b>4.3 </b>Thiết lập quyền truy cập
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
              
    </li>
  
 

            
          
        
        </ul>
              
    </li>
  
 

          
          




 
  
    
    <li data-nav-id="/vi/5-etl-pipeline/" title="Triển khai ETL Pipeline" class="dd-item 
        
        
        
        ">
      <a href="/vi/5-etl-pipeline/">
          <b>5. </b>Triển khai ETL Pipeline
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
      
        <ul>
          
          
            
          
          
          
        
          
            
            




 
  
    
    <li data-nav-id="/vi/5-etl-pipeline/1-create-glue-jobs/" title="Tạo Glue jobs" class="dd-item 
        
        
        
        ">
      <a href="/vi/5-etl-pipeline/1-create-glue-jobs/">
          <b>5.1 </b>Tạo Glue jobs
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
              
    </li>
  
 

            
          
            
            




 
  
    
    <li data-nav-id="/vi/5-etl-pipeline/2-setup-step-functions/" title="Thiết lập Step Functions" class="dd-item 
        
        
        
        ">
      <a href="/vi/5-etl-pipeline/2-setup-step-functions/">
          <b>5.2 </b>Thiết lập Step Functions
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
              
    </li>
  
 

            
          
            
            




 
  
    
    <li data-nav-id="/vi/5-etl-pipeline/3-configure-eventbridge/" title="Cấu hình EventBridge" class="dd-item 
        
        
        
        ">
      <a href="/vi/5-etl-pipeline/3-configure-eventbridge/">
          <b>5.3 </b>Cấu hình EventBridge
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
              
    </li>
  
 

            
          
        
        </ul>
              
    </li>
  
 

          
          




 
  
    
    <li data-nav-id="/vi/6-data-ingestion/" title="Nạp và xử lý dữ liệu" class="dd-item 
        parent
        
        
        ">
      <a href="/vi/6-data-ingestion/">
          <b>6. </b>Nạp và xử lý dữ liệu
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
      
        <ul>
          
          
            
          
          
          
        
          
            
            




 
  
    
    <li data-nav-id="/vi/6-data-ingestion/1-prepare-data/" title="Chuẩn bị dữ liệu mẫu" class="dd-item 
        
        active
        
        ">
      <a href="/vi/6-data-ingestion/1-prepare-data/">
          <b>6.1 </b>Chuẩn bị dữ liệu mẫu
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
              
    </li>
  
 

            
          
            
            




 
  
    
    <li data-nav-id="/vi/6-data-ingestion/2-upload-data/" title="Upload dữ liệu" class="dd-item 
        
        
        
        ">
      <a href="/vi/6-data-ingestion/2-upload-data/">
          <b>6.2 </b>Upload dữ liệu
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
              
    </li>
  
 

            
          
        
        </ul>
              
    </li>
  
 

          
          




 
  
    
    <li data-nav-id="/vi/7-athena-query/" title="Truy vấn dữ liệu với Athena" class="dd-item 
        
        
        
        ">
      <a href="/vi/7-athena-query/">
          <b>7. </b>Truy vấn dữ liệu với Athena
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
      
        <ul>
          
          
            
          
          
          
        
          
            
            




 
  
    
    <li data-nav-id="/vi/7-athena-query/1-setup-workgroup/" title="Thiết lập Athena Workgroup" class="dd-item 
        
        
        
        ">
      <a href="/vi/7-athena-query/1-setup-workgroup/">
          <b>7.1 </b>Thiết lập Athena Workgroup
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
              
    </li>
  
 

            
          
            
            




 
  
    
    <li data-nav-id="/vi/7-athena-query/2-create-crawler/" title="Tạo và chạy Glue Crawler" class="dd-item 
        
        
        
        ">
      <a href="/vi/7-athena-query/2-create-crawler/">
          <b>7.2 </b>Tạo và chạy Glue Crawler
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
              
    </li>
  
 

            
          
            
            




 
  
    
    <li data-nav-id="/vi/7-athena-query/3-run-queries/" title="Thực hiện truy vấn SQL" class="dd-item 
        
        
        
        ">
      <a href="/vi/7-athena-query/3-run-queries/">
          <b>7.3 </b>Thực hiện truy vấn SQL
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
              
    </li>
  
 

            
          
            
            




 
  
    
    <li data-nav-id="/vi/7-athena-query/4-create-views/" title="Tạo và sử dụng Views" class="dd-item 
        
        
        
        ">
      <a href="/vi/7-athena-query/4-create-views/">
          <b>7.4 </b>Tạo và sử dụng Views
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
              
    </li>
  
 

            
          
            
            




 
  
    
    <li data-nav-id="/vi/7-athena-query/5-export-results/" title="Export kết quả truy vấn" class="dd-item 
        
        
        
        ">
      <a href="/vi/7-athena-query/5-export-results/">
          <b>7.5 </b>Export kết quả truy vấn
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
              
    </li>
  
 

            
          
        
        </ul>
              
    </li>
  
 

          
          




 
  
    
    <li data-nav-id="/vi/8-monitoring/" title="Giám sát và xử lý sự cố" class="dd-item 
        
        
        
        ">
      <a href="/vi/8-monitoring/">
          <b>8. </b>Giám sát và xử lý sự cố
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
              
    </li>
  
 

          
          




 
  
    
    <li data-nav-id="/vi/9-cleanup/" title="Dọn dẹp tài nguyên" class="dd-item 
        
        
        
        ">
      <a href="/vi/9-cleanup/">
          <b>9. </b>Dọn dẹp tài nguyên
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
              
    </li>
  
 

          
         
    </ul>

    
    
      <section id="shortcuts">
        <h3>More</h3>
        <ul>
          
              <li> 
                  <a class="padding" href="http://awsstudygroup.com"><i class='fab fa-aws'></i> AWS Study Group - Blog</a>
              </li>
          
              <li> 
                  <a class="padding" href="https://www.facebook.com/groups/660548818043427/"><i class='fab fa-facebook'></i> AWS Study Group - Nhóm FB</a>
              </li>
          
        </ul>
      </section>
    

    
    <section id="prefooter">
      <hr/>
      <ul>
      
        <li>
          <a class="padding">
            <i class="fas fa-language fa-fw"></i>
          <div class="select-style">
            <select id="select-language" onchange="location = this.value;">
          
          
          
              
              
                  
              
                  
                    
                    
                      <option id="vi" value="/vi/6-data-ingestion/1-prepare-data/" selected>Tiếng Việt</option>
                    
                  
              
          
        </select>
        <svg version="1.1" id="Capa_1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px"
          width="255px" height="255px" viewBox="0 0 255 255" style="enable-background:new 0 0 255 255;" xml:space="preserve">
          <g>
            <g id="arrow-drop-down">
              <polygon points="0,63.75 127.5,191.25 255,63.75 		" />
            </g>
          </g>
        </svg>
        </div>
        </a>
        </li>
      
      
      
        <li><a class="padding" href="#" data-clear-history-toggle=""><i class="fas fa-history fa-fw"></i> Clear History</a></li>
      
      </ul>
    </section>
    
    <section id="footer">
      <left>
    
     <b> Workshop</b> <br>
    <img src="https://hitwebcounter.com/counter/counter.php?page=7831210&style=0038&nbdigits=9&type=page&initCount=0" title="Migrate" Alt="web counter"   border="0" /></a>  <br>
     <b> <a href="https://cloudjourney.awsstudygroup.com/">Cloud Journey</a></b> <br>
    <img src="https://hitwebcounter.com/counter/counter.php?page=7830807&style=0038&nbdigits=9&type=page&initCount=0" title="Total CLoud Journey" Alt="web counter"   border="0"   />
     
</left>
<left>
    <br>
    <br>
        <b> Last Updated </b> <br>
        <i><font color=orange>17-09-2021</font></i>
    </left>
    <left>
        <br>
        <br>
            <b> Team </b> <br>
           
            <i>
                <a href="https://www.linkedin.com/in/jotaguy"  style="color:orange">Gia Hưng</a>
        </i>
        </left>

<script async defer src="https://buttons.github.io/buttons.js"></script>

    </section>
  </div>
</nav>




        <section id="body">
        <div id="overlay"></div>
        <div class="padding highlightable">
              
              <div>
                <div id="top-bar">
                
                
                <div id="breadcrumbs" itemscope="" itemtype="http://data-vocabulary.org/Breadcrumb">
                    <span id="sidebar-toggle-span">
                        <a href="#" id="sidebar-toggle" data-sidebar-toggle="">
                          <i class="fas fa-bars"></i>
                        </a>
                    </span>
                  
                  <span id="toc-menu"><i class="fas fa-list-alt"></i></span>
                  
                  <span class="links">
                 
                 
                    
          
          
            
            
          
          
            
            
          
          
            <a href='/vi/'>Serverless Data Lake Framework Jump Start</a> > <a href='/vi/6-data-ingestion/'>Nạp và xử lý dữ liệu</a> > Chuẩn bị dữ liệu mẫu
          
        
          
        
          
        
                 
                  </span>
                </div>
                
                    <div class="progress">
    <div class="wrapper">
<nav id="TableOfContents">
  <ul>
    <li><a href="#chuẩn-bị-dữ-liệu-mẫu">Chuẩn bị dữ liệu mẫu</a>
      <ul>
        <li><a href="#các-bước-thực-hiện">Các bước thực hiện</a></li>
        <li><a href="#xử-lý-sự-cố">Xử lý sự cố</a></li>
        <li><a href="#tổng-kết">Tổng kết</a></li>
      </ul>
    </li>
    <li><a href="#bước-tiếp-theo">Bước tiếp theo</a></li>
  </ul>
</nav>
    </div>
</div>

                
              </div>
            </div>
            
        <div id="head-tags">
        
        </div>
        
        <div id="body-inner">
          
            <h1>
              
              Chuẩn bị dữ liệu mẫu
            </h1>
          

        



	<h2 id="chuẩn-bị-dữ-liệu-mẫu">Chuẩn bị dữ liệu mẫu</h2>
<p>Bước đầu tiên trong việc nạp dữ liệu là chuẩn bị dữ liệu mẫu để upload vào data lake. Trong phần này, chúng ta sẽ tạo hai loại dữ liệu mẫu:</p>
<ol>
<li><strong>Dữ liệu legislators</strong>: Chứa thông tin về các nhà lập pháp, bao gồm ID, tên, đảng phái, tiểu bang, và nhiệm kỳ.</li>
<li><strong>Dữ liệu transactions</strong>: Chứa thông tin về các giao dịch, bao gồm ID giao dịch, ID khách hàng, số tiền, loại tiền tệ, ngày giao dịch và danh mục.</li>
</ol>
<p>Cả hai loại dữ liệu này sẽ được lưu trữ dưới dạng JSON Lines, mỗi dòng là một đối tượng JSON hợp lệ.</p>
<h3 id="các-bước-thực-hiện">Các bước thực hiện</h3>
<h4 id="bước-1-tạo-thư-mục-cho-dữ-liệu-mẫu">Bước 1: Tạo thư mục cho dữ liệu mẫu</h4>
<p>Đầu tiên, chúng ta cần tạo một thư mục để lưu trữ các file dữ liệu mẫu. CloudShell cung cấp một môi trường làm việc tạm thời để chúng ta có thể tạo và quản lý các file.</p>
<ol>
<li>
<p>Mở AWS Management Console và tìm kiếm &ldquo;CloudShell&rdquo;</p>
</li>
<li>
<p>Khi CloudShell đã khởi động, nhập lệnh sau để tạo thư mục cho dữ liệu mẫu:</p>
</li>
</ol>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>mkdir -p ~/environment/sample-data
</span></span><span style="display:flex;"><span>cd ~/environment/sample-data
</span></span></code></pre></div><ol start="3">
<li>Nhấn Enter để thực hiện lệnh</li>
</ol>
<p><img alt="Tạo thư mục" src="../../../static/images/6/1/6.1.1_create_directory.png?width=40pc"></p>

<div class="notices tip" ><p>CloudShell là một terminal dựa trên trình duyệt được quản lý bởi AWS, cho phép bạn chạy các lệnh AWS CLI mà không cần cài đặt bất kỳ phần mềm nào trên máy tính của bạn.</p>
</div>

<h4 id="bước-2-tạo-dữ-liệu-mẫu-cho-legislators">Bước 2: Tạo dữ liệu mẫu cho legislators</h4>
<p>Tiếp theo, chúng ta sẽ tạo dữ liệu mẫu cho legislators. Dữ liệu này sẽ được lưu trữ dưới dạng JSON Lines, với mỗi dòng là một đối tượng JSON đại diện cho một nhà lập pháp.</p>
<ol>
<li>
<p>Trong CloudShell, đảm bảo bạn đang ở thư mục <code>~/environment/sample-data</code></p>
</li>
<li>
<p>Nhập lệnh sau để tạo file dữ liệu mẫu cho legislators:</p>
</li>
</ol>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>cat &gt; legislators.json <span style="color:#e6db74">&lt;&lt; &#39;EOL&#39;
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">{&#34;id&#34;: &#34;001&#34;, &#34;name&#34;: &#34;John Smith&#34;, &#34;party&#34;: &#34;Democratic&#34;, &#34;state&#34;: &#34;CA&#34;, &#34;chamber&#34;: &#34;Senate&#34;, &#34;start_date&#34;: &#34;2020-01-01&#34;, &#34;end_date&#34;: &#34;2026-01-01&#34;, &#34;is_current&#34;: true, &#34;term_length_days&#34;: 2191}
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">{&#34;id&#34;: &#34;002&#34;, &#34;name&#34;: &#34;Jane Doe&#34;, &#34;party&#34;: &#34;Republican&#34;, &#34;state&#34;: &#34;TX&#34;, &#34;chamber&#34;: &#34;House&#34;, &#34;start_date&#34;: &#34;2022-01-01&#34;, &#34;end_date&#34;: &#34;2024-01-01&#34;, &#34;is_current&#34;: true, &#34;term_length_days&#34;: 730}
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">{&#34;id&#34;: &#34;003&#34;, &#34;name&#34;: &#34;Robert Johnson&#34;, &#34;party&#34;: &#34;Democratic&#34;, &#34;state&#34;: &#34;NY&#34;, &#34;chamber&#34;: &#34;Senate&#34;, &#34;start_date&#34;: &#34;2018-01-01&#34;, &#34;end_date&#34;: &#34;2024-01-01&#34;, &#34;is_current&#34;: true, &#34;term_length_days&#34;: 2191}
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">{&#34;id&#34;: &#34;004&#34;, &#34;name&#34;: &#34;Emily Wilson&#34;, &#34;party&#34;: &#34;Republican&#34;, &#34;state&#34;: &#34;FL&#34;, &#34;chamber&#34;: &#34;House&#34;, &#34;start_date&#34;: &#34;2022-01-01&#34;, &#34;end_date&#34;: &#34;2024-01-01&#34;, &#34;is_current&#34;: true, &#34;term_length_days&#34;: 730}
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">{&#34;id&#34;: &#34;005&#34;, &#34;name&#34;: &#34;Michael Brown&#34;, &#34;party&#34;: &#34;Independent&#34;, &#34;state&#34;: &#34;OH&#34;, &#34;chamber&#34;: &#34;Senate&#34;, &#34;start_date&#34;: &#34;2020-01-01&#34;, &#34;end_date&#34;: &#34;2026-01-01&#34;, &#34;is_current&#34;: true, &#34;term_length_days&#34;: 2191}
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">EOL</span>
</span></span></code></pre></div><ol start="3">
<li>Nhấn Enter để thực hiện lệnh</li>
</ol>
<p><img alt="Tạo dữ liệu legislators" src="../../../static/images/6/1/6.1.2_create_legislators_data.png?width=40pc"></p>
<ol start="4">
<li>
<p>Lệnh trên sẽ tạo một file có tên <code>legislators.json</code> với 5 bản ghi. Mỗi bản ghi chứa các trường sau:</p>
<ul>
<li><strong>id</strong>: Mã định danh duy nhất của nhà lập pháp</li>
<li><strong>name</strong>: Tên của nhà lập pháp</li>
<li><strong>party</strong>: Đảng phái chính trị (Democratic, Republican, Independent)</li>
<li><strong>state</strong>: Tiểu bang (mã 2 ký tự của tiểu bang)</li>
<li><strong>chamber</strong>: Viện (Senate hoặc House)</li>
<li><strong>start_date</strong>: Ngày bắt đầu nhiệm kỳ (dạng YYYY-MM-DD)</li>
<li><strong>end_date</strong>: Ngày kết thúc nhiệm kỳ (dạng YYYY-MM-DD)</li>
<li><strong>is_current</strong>: Trạng thái hiện tại (true hoặc false)</li>
<li><strong>term_length_days</strong>: Độ dài nhiệm kỳ tính bằng ngày</li>
</ul>
</li>
</ol>
<h4 id="bước-3-tạo-dữ-liệu-mẫu-cho-transactions">Bước 3: Tạo dữ liệu mẫu cho transactions</h4>
<p>Sau khi đã tạo dữ liệu cho legislators, chúng ta sẽ tiếp tục tạo dữ liệu mẫu cho transactions. Dữ liệu này mô phỏng các giao dịch tài chính với các thông tin như ID giao dịch, ID khách hàng, số tiền, và danh mục giao dịch.</p>
<ol>
<li>
<p>Trong CloudShell, đảm bảo bạn vẫn đang ở thư mục <code>~/environment/sample-data</code></p>
</li>
<li>
<p>Nhập lệnh sau để tạo file dữ liệu mẫu cho transactions:</p>
</li>
</ol>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>cat &gt; transactions.json <span style="color:#e6db74">&lt;&lt; &#39;EOL&#39;
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">{&#34;transaction_id&#34;: &#34;tx001&#34;, &#34;customer_id&#34;: &#34;cust001&#34;, &#34;amount&#34;: 100.50, &#34;currency&#34;: &#34;USD&#34;, &#34;transaction_date&#34;: &#34;2024-01-15&#34;, &#34;merchant_category&#34;: &#34;retail&#34;}
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">{&#34;transaction_id&#34;: &#34;tx002&#34;, &#34;customer_id&#34;: &#34;cust002&#34;, &#34;amount&#34;: 75.25, &#34;currency&#34;: &#34;USD&#34;, &#34;transaction_date&#34;: &#34;2024-01-15&#34;, &#34;merchant_category&#34;: &#34;food&#34;}
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">{&#34;transaction_id&#34;: &#34;tx003&#34;, &#34;customer_id&#34;: &#34;cust001&#34;, &#34;amount&#34;: 200.00, &#34;currency&#34;: &#34;USD&#34;, &#34;transaction_date&#34;: &#34;2024-01-16&#34;, &#34;merchant_category&#34;: &#34;travel&#34;}
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">{&#34;transaction_id&#34;: &#34;tx004&#34;, &#34;customer_id&#34;: &#34;cust003&#34;, &#34;amount&#34;: 50.75, &#34;currency&#34;: &#34;USD&#34;, &#34;transaction_date&#34;: &#34;2024-01-16&#34;, &#34;merchant_category&#34;: &#34;retail&#34;}
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">{&#34;transaction_id&#34;: &#34;tx005&#34;, &#34;customer_id&#34;: &#34;cust002&#34;, &#34;amount&#34;: 120.00, &#34;currency&#34;: &#34;USD&#34;, &#34;transaction_date&#34;: &#34;2024-01-17&#34;, &#34;merchant_category&#34;: &#34;entertainment&#34;}
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">{&#34;transaction_id&#34;: &#34;tx006&#34;, &#34;customer_id&#34;: &#34;cust004&#34;, &#34;amount&#34;: 300.25, &#34;currency&#34;: &#34;USD&#34;, &#34;transaction_date&#34;: &#34;2024-01-17&#34;, &#34;merchant_category&#34;: &#34;travel&#34;}
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">{&#34;transaction_id&#34;: &#34;tx007&#34;, &#34;customer_id&#34;: &#34;cust001&#34;, &#34;amount&#34;: 45.00, &#34;currency&#34;: &#34;USD&#34;, &#34;transaction_date&#34;: &#34;2024-01-18&#34;, &#34;merchant_category&#34;: &#34;food&#34;}
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">{&#34;transaction_id&#34;: &#34;tx008&#34;, &#34;customer_id&#34;: &#34;cust005&#34;, &#34;amount&#34;: 500.00, &#34;currency&#34;: &#34;USD&#34;, &#34;transaction_date&#34;: &#34;2024-01-18&#34;, &#34;merchant_category&#34;: &#34;electronics&#34;}
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">{&#34;transaction_id&#34;: &#34;tx009&#34;, &#34;customer_id&#34;: &#34;cust002&#34;, &#34;amount&#34;: 25.50, &#34;currency&#34;: &#34;USD&#34;, &#34;transaction_date&#34;: &#34;2024-01-19&#34;, &#34;merchant_category&#34;: &#34;food&#34;}
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">{&#34;transaction_id&#34;: &#34;tx010&#34;, &#34;customer_id&#34;: &#34;cust003&#34;, &#34;amount&#34;: 150.75, &#34;currency&#34;: &#34;USD&#34;, &#34;transaction_date&#34;: &#34;2024-01-19&#34;, &#34;merchant_category&#34;: &#34;retail&#34;}
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">EOL</span>
</span></span></code></pre></div><ol start="3">
<li>Nhấn Enter để thực hiện lệnh</li>
</ol>
<p><img alt="Tạo dữ liệu transactions" src="../../../static/images/6/1/6.1.3_create_transactions_data.png?width=40pc"></p>
<ol start="4">
<li>
<p>Lệnh trên sẽ tạo một file có tên <code>transactions.json</code> với 10 bản ghi. Mỗi bản ghi chứa các trường sau:</p>
<ul>
<li><strong>transaction_id</strong>: Mã định danh duy nhất của giao dịch</li>
<li><strong>customer_id</strong>: Mã định danh của khách hàng thực hiện giao dịch</li>
<li><strong>amount</strong>: Số tiền giao dịch</li>
<li><strong>currency</strong>: Loại tiền tệ (USD, EUR, v.v.)</li>
<li><strong>transaction_date</strong>: Ngày thực hiện giao dịch (dạng YYYY-MM-DD)</li>
<li><strong>merchant_category</strong>: Danh mục của giao dịch (retail, food, travel, v.v.)</li>
</ul>
</li>
</ol>

<div class="notices note" ><p>Dữ liệu transactions này sẽ được sử dụng để mô phỏng dữ liệu giao dịch thực tế trong hệ thống tài chính. Trong môi trường thực tế, dữ liệu này có thể đến từ nhiều nguồn khác nhau như hệ thống thanh toán, ứng dụng di động, hoặc các kênh giao dịch khác.</p>
</div>

<h4 id="bước-4-kiểm-tra-dữ-liệu-mẫu">Bước 4: Kiểm tra dữ liệu mẫu</h4>
<p>Sau khi đã tạo các file dữ liệu mẫu, chúng ta cần kiểm tra để đảm bảo dữ liệu đã được tạo đúng định dạng và có đầy đủ các trường cần thiết.</p>
<ol>
<li>Trong CloudShell, nhập lệnh sau để kiểm tra nội dung của các file dữ liệu mẫu:</li>
</ol>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span><span style="color:#75715e"># Kiểm tra file legislators.json</span>
</span></span><span style="display:flex;"><span>cat legislators.json
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># Kiểm tra file transactions.json</span>
</span></span><span style="display:flex;"><span>cat transactions.json
</span></span></code></pre></div><ol start="2">
<li>Nhấn Enter để thực hiện từng lệnh</li>
</ol>
<p><img alt="Kiểm tra dữ liệu" src="../../../static/images/6/1/6.1.4_check_data.png?width=40pc"></p>
<ol start="3">
<li>
<p>Bạn sẽ thấy nội dung của các file dữ liệu mẫu</p>
</li>
<li>
<p>Để kiểm tra số lượng bản ghi trong mỗi file, bạn có thể sử dụng lệnh <code>wc -l</code>:</p>
</li>
</ol>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span><span style="color:#75715e"># Đếm số dòng trong file legislators.json</span>
</span></span><span style="display:flex;"><span>wc -l legislators.json
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># Đếm số dòng trong file transactions.json</span>
</span></span><span style="display:flex;"><span>wc -l transactions.json
</span></span></code></pre></div><ol start="5">
<li>Kết quả sẽ cho thấy file <code>legislators.json</code> có 5 dòng và file <code>transactions.json</code> có 10 dòng</li>
</ol>

<div class="notices tip" ><p>Kiểm tra dữ liệu trước khi upload là một bước quan trọng để đảm bảo quá trình ETL sẽ hoạt động đúng cách. Nếu dữ liệu không đúng định dạng, các bước xử lý sau này có thể gặp lỗi.</p>
</div>

<h4 id="bước-5-tạo-script-để-tạo-dữ-liệu-mẫu-lớn-hơn-tùy-chọn">Bước 5: Tạo script để tạo dữ liệu mẫu lớn hơn (tùy chọn)</h4>
<p>Trong môi trường thực tế, dữ liệu thường có khối lượng lớn hơn nhiều so với các file mẫu đơn giản mà chúng ta đã tạo. Để mô phỏng tốt hơn môi trường sản xuất, chúng ta có thể tạo một lượng dữ liệu lớn hơn bằng cách sử dụng script Python.</p>
<ol>
<li>Nếu bạn muốn tạo dữ liệu mẫu lớn hơn, bạn có thể sử dụng script Python sau. Script này sẽ tạo 100 bản ghi legislators và 1000 bản ghi transactions với dữ liệu ngẫu nhiên:</li>
</ol>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>cat &gt; generate_data.py <span style="color:#e6db74">&lt;&lt; &#39;EOL&#39;
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">import json
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">import random
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">from datetime import datetime, timedelta
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">import uuid
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74"># Tạo dữ liệu legislators
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">def generate_legislators(count=100):
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">    parties = [&#34;Democratic&#34;, &#34;Republican&#34;, &#34;Independent&#34;]
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">    states = [&#34;AL&#34;, &#34;AK&#34;, &#34;AZ&#34;, &#34;AR&#34;, &#34;CA&#34;, &#34;CO&#34;, &#34;CT&#34;, &#34;DE&#34;, &#34;FL&#34;, &#34;GA&#34;, 
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">              &#34;HI&#34;, &#34;ID&#34;, &#34;IL&#34;, &#34;IN&#34;, &#34;IA&#34;, &#34;KS&#34;, &#34;KY&#34;, &#34;LA&#34;, &#34;ME&#34;, &#34;MD&#34;, 
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">              &#34;MA&#34;, &#34;MI&#34;, &#34;MN&#34;, &#34;MS&#34;, &#34;MO&#34;, &#34;MT&#34;, &#34;NE&#34;, &#34;NV&#34;, &#34;NH&#34;, &#34;NJ&#34;, 
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">              &#34;NM&#34;, &#34;NY&#34;, &#34;NC&#34;, &#34;ND&#34;, &#34;OH&#34;, &#34;OK&#34;, &#34;OR&#34;, &#34;PA&#34;, &#34;RI&#34;, &#34;SC&#34;, 
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">              &#34;SD&#34;, &#34;TN&#34;, &#34;TX&#34;, &#34;UT&#34;, &#34;VT&#34;, &#34;VA&#34;, &#34;WA&#34;, &#34;WV&#34;, &#34;WI&#34;, &#34;WY&#34;]
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">    chambers = [&#34;Senate&#34;, &#34;House&#34;]
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">    
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">    legislators = []
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">    for i in range(1, count + 1):
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">        id_str = f&#34;{i:03d}&#34;
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">        party = random.choice(parties)
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">        state = random.choice(states)
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">        chamber = random.choice(chambers)
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">        
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">        start_year = random.randint(2018, 2022)
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">        start_date = f&#34;{start_year}-01-01&#34;
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">        
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">        term_years = 6 if chamber == &#34;Senate&#34; else 2
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">        end_year = start_year + term_years
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">        end_date = f&#34;{end_year}-01-01&#34;
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">        
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">        term_length_days = term_years * 365
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">        
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">        legislator = {
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">            &#34;id&#34;: id_str,
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">            &#34;name&#34;: f&#34;Legislator {id_str}&#34;,
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">            &#34;party&#34;: party,
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">            &#34;state&#34;: state,
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">            &#34;chamber&#34;: chamber,
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">            &#34;start_date&#34;: start_date,
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">            &#34;end_date&#34;: end_date,
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">            &#34;is_current&#34;: True,
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">            &#34;term_length_days&#34;: term_length_days
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">        }
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">        legislators.append(legislator)
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">    
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">    return legislators
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74"># Tạo dữ liệu transactions
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">def generate_transactions(count=1000):
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">    merchant_categories = [&#34;retail&#34;, &#34;food&#34;, &#34;travel&#34;, &#34;entertainment&#34;, &#34;electronics&#34;, &#34;healthcare&#34;, &#34;education&#34;, &#34;utilities&#34;]
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">    currencies = [&#34;USD&#34;, &#34;EUR&#34;, &#34;GBP&#34;, &#34;JPY&#34;, &#34;CAD&#34;, &#34;AUD&#34;]
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">    
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">    transactions = []
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">    for i in range(1, count + 1):
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">        transaction_id = f&#34;tx{i:06d}&#34;
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">        customer_id = f&#34;cust{random.randint(1, 100):03d}&#34;
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">        amount = round(random.uniform(10, 1000), 2)
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">        currency = random.choice(currencies)
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">        
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">        # Ngày giao dịch trong khoảng 30 ngày gần đây
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">        days_ago = random.randint(0, 30)
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">        transaction_date = (datetime.now() - timedelta(days=days_ago)).strftime(&#34;%Y-%m-%d&#34;)
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">        
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">        merchant_category = random.choice(merchant_categories)
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">        
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">        transaction = {
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">            &#34;transaction_id&#34;: transaction_id,
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">            &#34;customer_id&#34;: customer_id,
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">            &#34;amount&#34;: amount,
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">            &#34;currency&#34;: currency,
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">            &#34;transaction_date&#34;: transaction_date,
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">            &#34;merchant_category&#34;: merchant_category
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">        }
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">        transactions.append(transaction)
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">    
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">    return transactions
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74"># Tạo và lưu dữ liệu
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">def save_data(data, filename):
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">    with open(filename, &#39;w&#39;) as f:
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">        for item in data:
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">            f.write(json.dumps(item) + &#39;\n&#39;)
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74"># Tạo dữ liệu
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">legislators = generate_legislators(100)
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">transactions = generate_transactions(1000)
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74"># Lưu dữ liệu
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">save_data(legislators, &#39;legislators_large.json&#39;)
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">save_data(transactions, &#39;transactions_large.json&#39;)
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">print(f&#34;Generated {len(legislators)} legislators and {len(transactions)} transactions&#34;)
</span></span></span><span style="display:flex;"><span><span style="color:#e6db74">EOL</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># Cài đặt Python nếu cần</span>
</span></span><span style="display:flex;"><span>pip install --user datetime
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># Chạy script</span>
</span></span><span style="display:flex;"><span>python generate_data.py
</span></span></code></pre></div><ol start="2">
<li>Nhấn Enter để thực hiện lệnh</li>
</ol>
<p><img alt="Tạo script" src="../../../static/images/6/1/6.1.5_create_script.png?width=40pc"></p>
<ol start="3">
<li>Bạn sẽ thấy thông báo về số lượng bản ghi đã được tạo</li>
</ol>
<h4 id="bước-6-kiểm-tra-dữ-liệu-mẫu-lớn-nếu-đã-tạo">Bước 6: Kiểm tra dữ liệu mẫu lớn (nếu đã tạo)</h4>
<p>Sau khi chạy script Python để tạo dữ liệu mẫu lớn hơn, chúng ta cần kiểm tra các file đã được tạo để đảm bảo chúng có đúng số lượng bản ghi như mong đợi.</p>
<ol>
<li>Nếu bạn đã tạo dữ liệu mẫu lớn, nhập lệnh sau để kiểm tra số lượng bản ghi:</li>
</ol>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span><span style="color:#75715e"># Đếm số dòng trong file legislators_large.json</span>
</span></span><span style="display:flex;"><span>wc -l legislators_large.json
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#75715e"># Đếm số dòng trong file transactions_large.json</span>
</span></span><span style="display:flex;"><span>wc -l transactions_large.json
</span></span></code></pre></div><ol start="2">
<li>Nhấn Enter để thực hiện từng lệnh</li>
</ol>
<p><img alt="Kiểm tra dữ liệu lớn" src="../../../static/images/6/1/6.1.6_check_large_data.png?width=40pc"></p>
<ol start="3">
<li>
<p>Bạn sẽ thấy kết quả hiển thị số lượng bản ghi trong mỗi file:</p>
<ul>
<li><code>legislators_large.json</code>: 100 bản ghi</li>
<li><code>transactions_large.json</code>: 1000 bản ghi</li>
</ul>
</li>
<li>
<p>Bạn cũng có thể kiểm tra kích thước của các file bằng lệnh:</p>
</li>
</ol>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span><span style="color:#75715e"># Kiểm tra kích thước của các file</span>
</span></span><span style="display:flex;"><span>ls -lh legislators*.json transactions*.json
</span></span></code></pre></div><ol start="5">
<li>Lệnh này sẽ hiển thị kích thước của cả các file dữ liệu mẫu nhỏ và lớn</li>
</ol>

<div class="notices note" ><p>Việc tạo dữ liệu mẫu lớn hơn giúp kiểm tra hiệu suất của ETL pipeline và khả năng xử lý của hệ thống với khối lượng dữ liệu lớn hơn. Tuy nhiên, để tiết kiệm thời gian trong workshop này, bạn có thể chỉ sử dụng các file dữ liệu mẫu nhỏ hơn đã tạo ở các bước trước.</p>
</div>

<h3 id="xử-lý-sự-cố">Xử lý sự cố</h3>
<p><strong>Vấn đề</strong>: Lỗi &ldquo;command not found: python&rdquo;
<strong>Giải pháp</strong>:</p>
<ol>
<li>Sử dụng <code>python3</code> thay vì <code>python</code>:
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>python3 generate_data.py
</span></span></code></pre></div></li>
<li>Hoặc cài đặt Python trong CloudShell:
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>sudo yum install -y python3
</span></span></code></pre></div></li>
</ol>
<p><strong>Vấn đề</strong>: Lỗi &ldquo;ModuleNotFoundError: No module named &lsquo;datetime&rsquo;&rdquo;
<strong>Giải pháp</strong>:</p>
<ol>
<li>Cài đặt thư viện datetime:
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>pip3 install --user datetime
</span></span></code></pre></div></li>
</ol>
<p><strong>Vấn đề</strong>: Lỗi khi tạo file dữ liệu mẫu
<strong>Giải pháp</strong>:</p>
<ol>
<li>Kiểm tra quyền truy cập thư mục:
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>ls -la ~/environment/sample-data
</span></span></code></pre></div></li>
<li>Đảm bảo bạn có đủ dung lượng trống:
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>df -h
</span></span></code></pre></div></li>
<li>Thử tạo file với nội dung ngắn hơn:
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>echo <span style="color:#e6db74">&#39;{&#34;test&#34;: &#34;data&#34;}&#39;</span> &gt; test.json
</span></span></code></pre></div></li>
</ol>
<p><strong>Vấn đề</strong>: Lỗi &ldquo;Permission denied&rdquo; khi chạy script Python
<strong>Giải pháp</strong>:</p>
<ol>
<li>Thêm quyền thực thi cho script:
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>chmod +x generate_data.py
</span></span></code></pre></div></li>
</ol>

<div class="notices tip" ><p>Bạn có thể tùy chỉnh dữ liệu mẫu theo nhu cầu của mình. Các file JSON được tạo ra có định dạng JSON Lines, với mỗi dòng là một đối tượng JSON hợp lệ. Định dạng này rất phổ biến trong các hệ thống xử lý dữ liệu lớn vì nó cho phép xử lý từng bản ghi một cách độc lập.</p>
</div>

<h3 id="tổng-kết">Tổng kết</h3>
<p>Trong phần này, chúng ta đã hoàn thành các bước sau:</p>
<ol>
<li>Tạo thư mục cho dữ liệu mẫu trong CloudShell</li>
<li>Tạo dữ liệu mẫu cho legislators với 5 bản ghi</li>
<li>Tạo dữ liệu mẫu cho transactions với 10 bản ghi</li>
<li>Kiểm tra dữ liệu mẫu đã tạo</li>
<li>(Tùy chọn) Tạo dữ liệu mẫu lớn hơn với script Python</li>
</ol>
<p>Dữ liệu mẫu này sẽ được sử dụng trong bước tiếp theo để upload vào data lake và kích hoạt ETL pipeline.</p>
<h2 id="bước-tiếp-theo">Bước tiếp theo</h2>
<p>Tiếp theo, chúng ta sẽ <a href="/vi/6-data-ingestion/2-upload-data/">Upload dữ liệu</a> vào data lake để kích hoạt ETL pipeline và theo dõi quá trình xử lý dữ liệu.</p>





<footer class=" footline" >
	
</footer>

        
        </div> 
        

      </div>

    <div id="navigation">
        
        
        
        
            
            
                
                    
                    
                
                

                    
                    
                        
                    
                    

                    
                        
            
            
                
                    
                        
                        
                    
                
                

                    
                    
                        
                    
                    

                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                        
                    
                    

                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                        
                    
                    

                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                        
                    
                    

                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                        
                    
                    

                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
            
        
                    
                        
            
            
                
                    
                    
                
                

                    
                    
                        
                    
                    

                    
                        
            
            
                
                    
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                        
                        
                    
                
                

                    
                    
                    

                    
            
        
                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                        
                    
                    

                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
            
        
        
        


	 
	 
		
			<a class="nav nav-prev" href="/vi/6-data-ingestion/" title="Nạp và xử lý dữ liệu"> <i class="fa fa-chevron-left"></i></a>
		
		
			<a class="nav nav-next" href="/vi/6-data-ingestion/2-upload-data/" title="Upload dữ liệu" style="margin-right: 0px;"><i class="fa fa-chevron-right"></i></a>
		
	
    </div>

    </section>
    
    <div style="left: -1000px; overflow: scroll; position: absolute; top: -1000px; border: none; box-sizing: content-box; height: 200px; margin: 0px; padding: 0px; width: 200px;">
      <div style="border: none; box-sizing: content-box; height: 200px; margin: 0px; padding: 0px; width: 200px;"></div>
    </div>
    <script src="/js/clipboard.min.js?1752741802"></script>
    <script src="/js/perfect-scrollbar.min.js?1752741802"></script>
    <script src="/js/perfect-scrollbar.jquery.min.js?1752741802"></script>
    <script src="/js/jquery.sticky.js?1752741802"></script>
    <script src="/js/featherlight.min.js?1752741802"></script>
    <script src="/js/highlight.pack.js?1752741802"></script>
    <script>hljs.initHighlightingOnLoad();</script>
    <script src="/js/modernizr.custom-3.6.0.js?1752741802"></script>
    <script src="/js/learn.js?1752741802"></script>
    <script src="/js/hugo-learn.js?1752741802"></script>

    <link href="/mermaid/mermaid.css?1752741802" rel="stylesheet" />
    <script src="/mermaid/mermaid.js?1752741802"></script>
    <script>
        mermaid.initialize({ startOnLoad: true });
    </script>
    <script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-158079754-2', 'auto');
  ga('send', 'pageview');

</script>
  </body>
</html>
